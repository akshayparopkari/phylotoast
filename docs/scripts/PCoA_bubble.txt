PCoA_bubble.py
===============

Create a series of Principle Coordinate plots for each OTU in an input list where the plot points are varied in size by the relative abundance of the OTU (relative to either Sample or the total contribution of the OTU to the data set.

.. code-block:: bash

    usage: PCoA_bubble.py [-h] -i OTU_TABLE -u UNIFRAC -d NAMES_COLORS_IDS_FN -m MAPPING -c MAP_CATEGORY [-o OUTPUT_DIR] [--scaling_factor SCALING_FACTOR] [-v]

Required Arguments
-------------------

.. cmdoption:: -i OTU_TABLE, --otu_table OTU_TABLE

    The biom-format file with OTU-Sample abundance data.

.. cmdoption:: -m MAPPING, --mapping MAPPING

    The mapping file specifying group information for each sample.

.. cmdoption:: -u UNIFRAC, --unifrac UNIFRAC

    Principle coordinates analysis file. Eg. unweighted_unifrac_pc.txt

.. cmdoption:: -b GROUP_BY, --group_by GROUP_BY

    Column name in mapping file specifying group information.

.. cmdoption::  -c COLORS, --colors COLORS

    A column name in the mapping file containing hexadecimal (#FF0000) color values that will be used to color the groups. Each sample ID must have a color entry.

.. cmdoption:: -d NAMES_COLORS_IDS_FN, --names_colors_ids_fn NAMES_COLORS_IDS_FN

    File containing one OTU name per line for plotting.

Optional Arguments
------------------

.. cmdoption:: -o OUTPUT_DIR, --output_dir OUTPUT_DIR

    The directory to output the PCoA plots to.

.. cmdoption:: -s SAVE_AS, --save_as SAVE_AS

    The type of image file for PCoA plots. By default, files will be saved in SVG format.

.. cmdoption::  --scale_by SCALE_BY

    Species relative abundance is multiplied by this factor in order to make appropriate visible bubbles in the output plots. Default is 10000.

.. cmdoption:: --ggplot2_style

    Apply ggplot2 styling to the figure.

.. cmdoption:: -v, --verbose

    Displays species name as each is being plotted and saved.

.. cmdoption:: -h, --help

    Show this help message and exit

Example plot
--------------

PCoA bubble plots of subgingival microbiome pathogens of smokers [1]_.

.. image:: PCoA/PCoA_bubble_example_smokers_pathogens.png
   :scale: 50%
   :align: center

Citation:

.. [1] **The Subgingival Microbiome of Clinically Healthy Current and Never Smokers**. Matthew R Mason, Philip M Preshaw, Haikady N Nagaraja, Shareef M Dabdoub, Anis Rahman and Purnima S Kumar; doi: `10.1038/ismej.2014.114 <http://dx.doi.org/10.1038/ismej.2014.114>`_
